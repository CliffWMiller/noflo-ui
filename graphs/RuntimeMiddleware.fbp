INPORT=Dispatch.IN:IN
OUTPORT=Passed.OUT:PASS
OUTPORT=NewActions.OUT:NEW

'context:edges,workspace:project,runtime:connect' -> ROUTES Dispatch(ui/DispatchAction)
Dispatch PASS -> IN Passed(core/Merge)

# New actions generated by this middleware
'runtime:connect' -> ACTION RuntimeConnectAction(ui/SetAction) OUT -> IN NewActions(core/Merge)
'runtime:error' -> ACTION RuntimeErrorAction(ui/SetAction) OUT -> IN NewActions
'workspace:runtime' -> ACTION WorkspaceRuntimeAction(ui/SetAction) OUT -> IN NewActions
'workspace:project' -> ACTION WorkspaceProjectAction(ui/SetAction) OUT -> IN Passed

# Send selected edges to runtime
'runtime,graphs[0]' -> KEYS GetEdgeState(ui/GetActionValues)
Dispatch HANDLE[0] -> IN GetEdgeState
GetEdgeState VALUES[0] -> RUNTIME SendEdges(runtime/SendEdges)
GetEdgeState VALUES[1] -> GRAPH SendEdges
GetEdgeState OUT -> EDGES SendEdges
SendEdges OUT -> IN Passed

# Add runtime to project if user has chosen one
Dispatch HANDLE[1] -> IN PopulateProjectWorkspace(ui/PopulateProjectRuntime)
PopulateProjectWorkspace OUT -> IN WorkspaceProjectAction
PopulateProjectWorkspace CONNECT -> IN RuntimeConnectAction

# Connecting to a runtime
Dispatch HANDLE[2] -> IN GetRuntimeDefinition(ui/GetActionValues)
GetRuntimeDefinition OUT -> DEFINITION Connect(runtime/ConnectRuntime)
'body' -> SELECTOR GetRuntimeElement(dom/GetElement) ELEMENT -> ELEMENT Connect
Connect RUNTIME -> IN WorkspaceRuntimeAction
Connect ERROR -> IN RuntimeErrorAction
