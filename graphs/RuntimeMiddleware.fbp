INPORT=Dispatch.IN:IN
OUTPORT=Passed.OUT:PASS
OUTPORT=NewActions.OUT:NEW

'context:edges,workspace:project,runtime:connect,runtime:connected' -> ROUTES Dispatch(ui/DispatchAction)
Dispatch PASS -> IN Passed(core/Merge)

# New actions generated by this middleware
'runtime:connect' -> ACTION RuntimeConnectAction(ui/SetAction) OUT -> IN NewActions(core/Merge)
'runtime:connected' -> ACTION RuntimeConnectedAction(ui/SetAction) OUT -> IN NewActions
'runtime:unavailable' -> ACTION RuntimeUnavailableAction(ui/SetAction) OUT -> IN NewActions
'runtime:error' -> ACTION RuntimeErrorAction(ui/SetAction) OUT -> IN NewActions
'workspace:runtime' -> ACTION WorkspaceRuntimeAction(ui/SetAction) OUT -> IN NewActions
'workspace:componentdefinition' -> ACTION WorkspaceComponentAction(ui/SetAction) OUT -> IN NewActions
# Actions manipulated and passed on by this middleware
'workspace:project' -> ACTION WorkspaceProjectAction(ui/SetAction) OUT -> IN Passed

# Send selected edges to runtime
'runtime,graphs[0]' -> KEYS GetEdgeState(ui/GetActionValues)
Dispatch HANDLE[0] -> IN GetEdgeState
GetEdgeState VALUES[0] -> RUNTIME SendEdges(runtime/SendEdges)
GetEdgeState VALUES[1] -> GRAPH SendEdges
GetEdgeState OUT -> EDGES SendEdges
SendEdges OUT -> IN Passed

# Add runtime to project if user has chosen one
Dispatch HANDLE[1] -> IN PopulateProjectWorkspace(ui/PopulateProjectRuntime)
PopulateProjectWorkspace OUT -> IN WorkspaceProjectAction
PopulateProjectWorkspace CONNECT -> IN RuntimeConnectAction

# Connecting to a runtime
Dispatch HANDLE[2] -> IN GetRuntimeDefinition(ui/GetActionValues)
GetRuntimeDefinition OUT -> DEFINITION Connect(runtime/ConnectRuntime)
'10000' -> TIMEOUT Connect
'body' -> SELECTOR GetRuntimeElement(dom/GetElement) ELEMENT -> ELEMENT Connect
Connect RUNTIME -> IN WorkspaceRuntimeAction
Connect CONNECTED -> IN RuntimeConnectedAction
Connect UNAVAILABLE -> IN RuntimeUnavailableAction
Connect ERROR -> IN RuntimeErrorAction

# Dealing with a connected runtime
Dispatch HANDLE[3] -> IN ConnectedRuntime(ui/GetActionValues)
ConnectedRuntime OUT -> RUNTIME ListComponents(runtime/ListComponents)
ListComponents OUT -> IN WorkspaceComponentAction
ListComponents ERROR -> IN RuntimeErrorAction
